const a2_0x116416=a2_0x1984;(function(_0x11bd60,_0x1e0e3b){const _0x6a11a0=a2_0x1984,_0x53f88a=_0x11bd60();while(!![]){try{const _0x3e8266=parseInt(_0x6a11a0(0x231))/0x1*(-parseInt(_0x6a11a0(0x209))/0x2)+-parseInt(_0x6a11a0(0x206))/0x3*(-parseInt(_0x6a11a0(0x22b))/0x4)+parseInt(_0x6a11a0(0x236))/0x5*(parseInt(_0x6a11a0(0x1f4))/0x6)+-parseInt(_0x6a11a0(0x216))/0x7+-parseInt(_0x6a11a0(0x21e))/0x8+parseInt(_0x6a11a0(0x1da))/0x9*(parseInt(_0x6a11a0(0x1e2))/0xa)+parseInt(_0x6a11a0(0x205))/0xb*(parseInt(_0x6a11a0(0x201))/0xc);if(_0x3e8266===_0x1e0e3b)break;else _0x53f88a['push'](_0x53f88a['shift']());}catch(_0x4e2caa){_0x53f88a['push'](_0x53f88a['shift']());}}}(a2_0xf4a9,0xe601d));const a2_0x323836=(function(){let _0x1d3b6f=!![];return function(_0x57f993,_0x3b1dc5){const _0x413f1e=_0x1d3b6f?function(){if(_0x3b1dc5){const _0x3f2a09=_0x3b1dc5['apply'](_0x57f993,arguments);return _0x3b1dc5=null,_0x3f2a09;}}:function(){};return _0x1d3b6f=![],_0x413f1e;};}()),a2_0x5903d8=a2_0x323836(this,function(){const _0x59c05e=a2_0x1984;return a2_0x5903d8[_0x59c05e(0x1d8)]()[_0x59c05e(0x1ec)](_0x59c05e(0x240))[_0x59c05e(0x1d8)]()[_0x59c05e(0x230)](a2_0x5903d8)[_0x59c05e(0x1ec)](_0x59c05e(0x240));});function a2_0xf4a9(){const _0x12d468=['sobject','from','./wrappers.js','create','finish','---\x20_processingTestSuccessful','12kgRodY','_saveAttachment','exports','Lattest_Test_Execution_Result__c','8572476bRrOmJ','3qIEBok','runTestResult','Body','2nzbyAO','errorMessage','details','Overall_Code_Coverage__c','metadata','---\x20_retrieveLargeTestCoverage','Create\x20Test\x20Log\x20record','startDate','Date__c','Tests_Failed__c','./util.js','numberTestErrors','_processingTestSuccessful','9469292ffIQPF','testResultWraper','Start\x20retrieve\x20test\x20coverage\x20result','Job_Completed__c','---\x20_updateOrg','Start\x20processing\x20test\x20coverage\x20result','connectionTarget','length','9426288hdQoKd','Test\x20coverage\x20result\x20was\x20retrieved','then','Name','Code_Coverage__c','successes','test-result-node','retrieve','resolve','codeCoverage','_updateOrg','stringify','logger','5638636FfAnyX','Attachment','numLocations','testResultString\x20size\x20=\x20','toLowerCase','constructor','848308FwztrA','---\x20_finishedProcess','/apex/','Test\x20result\x20attachment\x20created','Create\x20Process\x20from\x20node\x20app','3005afBlhw','Organisation__c','codecoveragedetails?id=','numLocationsNotCovered','Proccess\x20','numTestsRun','ContentType','connectionSource','addLine','logRecordId','(((.+)+)+)+$','Description','codeCoverageWarnings','numberTestsTotal','Create\x20test\x20result\x20attachment','totalTime','---\x20_createTestLogRecord','application/json','Total_Tests__c','The\x20process\x20ended\x20with\x20an\x20error','forEach','catch','log','logRecord','toString','flosumContants','9ioHkmY','success','_retrieveLargeTestCoverage','./logger.js','numFailures','---\x20_saveAttachment','Org\x20was\x20updated','Deploy\x20hasn`t\x20details','11456420ruWKbB','---logRecord\x20','Status__c','_finishedProcess','STATUS_IN_PROGRESS','Result\x20details\x20too\x20large\x20(more\x20than\x2030mb);\x20','asyncJobId','flowCoverageWarnings','numberTestsCompleted','failures','search','---\x20start\x20','Attachment\x20has\x20been\x20updated','update','Succeed__c','Deploy\x20hasn\x27t\x20details','Tests_Passed__c','_deleteDetailsFromResult','9852sHgvZj','totalCodeCoverage','namespacePrefix','push','STATUS_COMPLETED','done','_createTestLogRecord'];a2_0xf4a9=function(){return _0x12d468;};return a2_0xf4a9();}a2_0x5903d8();function a2_0x1984(_0x50306e,_0x14492f){const _0x4897ac=a2_0xf4a9();return a2_0x1984=function(_0x5903d8,_0x323836){_0x5903d8=_0x5903d8-0x1d8;let _0xf4a926=_0x4897ac[_0x5903d8];return _0xf4a926;},a2_0x1984(_0x50306e,_0x14492f);}const {Test_Log__c,Attachment,Organisation__c,Flosum_Constants,TestResultWraper,CodeCoverageResult,CodeCoverageWarning,RunTestFailure,FlowCoverageResult,FlowCoverageWarning,RunTestSuccess}=require(a2_0x116416(0x1fd)),{deleteObjectFieldsPrefix,addObjectFieldsPrefix,formErrorMessage}=require(a2_0x116416(0x213)),Logger=require(a2_0x116416(0x1dd));class Process{[a2_0x116416(0x1f5)]=0x0;[a2_0x116416(0x217)]=null;[a2_0x116416(0x23f)]='';['logger']=null;constructor(_0x113776,_0x11ec42,_0x19bb4b,_0x5b4adc,_0x1677f6){const _0x48536c=a2_0x116416;this[_0x48536c(0x23d)]=_0x113776,this[_0x48536c(0x21c)]=_0x11ec42,this[_0x48536c(0x24d)]=new Test_Log__c(JSON['parse'](_0x5b4adc),_0x1677f6),this['flosumContants']=new Flosum_Constants(),this[_0x48536c(0x1e8)]=_0x19bb4b,this[_0x48536c(0x1f6)]=_0x1677f6,this[_0x48536c(0x22a)]=new Logger(this[_0x48536c(0x23d)]),this['logger'][_0x48536c(0x23e)](_0x48536c(0x235));}['start'](){return new Promise((_0x2102de,_0x2424be)=>{const _0x24b127=a2_0x1984;console[_0x24b127(0x24c)](_0x24b127(0x1ed)),Promise[_0x24b127(0x226)]()[_0x24b127(0x220)](()=>this[_0x24b127(0x1dc)]())['then']((_0xe5c556={})=>{const _0xb9f59e=_0x24b127;if(_0xe5c556[_0xb9f59e(0x1f9)]&&!!_0xe5c556['details']&&!!_0xe5c556[_0xb9f59e(0x20b)][_0xb9f59e(0x207)])return this[_0xb9f59e(0x215)](_0xe5c556);else this[_0xb9f59e(0x22a)][_0xb9f59e(0x23e)](_0xb9f59e(0x1e1)),_0x2424be(_0xb9f59e(0x1f1));})[_0x24b127(0x220)](()=>this[_0x24b127(0x1fa)]())[_0x24b127(0x220)](()=>this[_0x24b127(0x202)]())[_0x24b127(0x220)](()=>this['_updateOrg']())['then'](()=>this['_finishedProcess']())[_0x24b127(0x220)](()=>{const _0x3b24c4=_0x24b127;_0x2102de(_0x3b24c4(0x1ee));})[_0x24b127(0x24b)](_0x1e1f32=>{const _0x12b46a=_0x24b127;this[_0x12b46a(0x22a)][_0x12b46a(0x23e)](_0x12b46a(0x249)),this[_0x12b46a(0x23f)]?.[_0x12b46a(0x21d)]&&this[_0x12b46a(0x22a)][_0x12b46a(0x1ff)](this[_0x12b46a(0x23f)]),_0x2424be({'message':_0x1e1f32,'logger':this[_0x12b46a(0x22a)]});});});}[a2_0x116416(0x1dc)](){return new Promise((_0x5756d4,_0x33e79e)=>{const _0x49eb09=a2_0x1984;console[_0x49eb09(0x24c)](_0x49eb09(0x20e)),this[_0x49eb09(0x22a)][_0x49eb09(0x23e)](_0x49eb09(0x218)),this[_0x49eb09(0x21c)][_0x49eb09(0x20d)]['checkDeployStatus'](this[_0x49eb09(0x1e8)],!![])[_0x49eb09(0x220)](_0x467443=>{const _0x3449a4=_0x49eb09;_0x467443['done']&&(this[_0x3449a4(0x24d)][_0x3449a4(0x211)]=_0x467443[_0x3449a4(0x210)],this['logRecord'][_0x3449a4(0x1f0)]=_0x467443[_0x3449a4(0x1db)],this[_0x3449a4(0x24d)][_0x3449a4(0x212)]=_0x467443[_0x3449a4(0x214)],this['logRecord'][_0x3449a4(0x248)]=_0x467443['numberTestsTotal'],this[_0x3449a4(0x24d)][_0x3449a4(0x1f2)]=_0x467443[_0x3449a4(0x1ea)]),this[_0x3449a4(0x22a)]['addLine'](_0x3449a4(0x21f)),_0x5756d4(_0x467443);})['catch'](_0x5199ea=>_0x33e79e(formErrorMessage(_0x5199ea,_0x49eb09(0x1dc),this['logger'])));});}[a2_0x116416(0x215)](_0x34206c){const _0x120d9d=a2_0x116416;try{console['log'](_0x120d9d(0x200)),console[_0x120d9d(0x24c)](_0x120d9d(0x23a)+0x0),this[_0x120d9d(0x22a)]['addLine'](_0x120d9d(0x21b));const _0x37be07=new TestResultWraper();_0x37be07['success']=_0x34206c[_0x120d9d(0x1db)],console[_0x120d9d(0x24c)](_0x120d9d(0x23a)+0x1);_0x34206c[_0x120d9d(0x20a)]!=null&&(_0x37be07['errorMessage']=_0x34206c['errorMessage']);console[_0x120d9d(0x24c)](_0x120d9d(0x23a)+0x2),_0x37be07[_0x120d9d(0x1de)]=_0x34206c['numberTestErrors'],_0x37be07['numTestsRun']=_0x34206c[_0x120d9d(0x243)],console[_0x120d9d(0x24c)](_0x120d9d(0x23a)+0x3),_0x37be07[_0x120d9d(0x245)]=parseInt(_0x34206c[_0x120d9d(0x20b)][_0x120d9d(0x207)]['totalTime']);if(_0x34206c[_0x120d9d(0x20b)][_0x120d9d(0x207)][_0x120d9d(0x227)]!=null){let _0x412d8a=0x0,_0x4b1a51=0x0,_0x41e2d1=0x0;_0x34206c[_0x120d9d(0x20b)][_0x120d9d(0x207)]['codeCoverage'][_0x120d9d(0x24a)](_0x1b14b5=>{const _0xa587c4=_0x120d9d;_0x412d8a+=parseInt(_0x1b14b5[_0xa587c4(0x22d)]),_0x4b1a51+=parseInt(_0x1b14b5['numLocationsNotCovered']);let _0x584fca=parseInt(_0x1b14b5[_0xa587c4(0x22d)]),_0xaa3826=_0x584fca-parseInt(_0x1b14b5[_0xa587c4(0x239)]);if(_0x584fca!=null&&_0x584fca!=0x0){let _0x2d50f6=_0xaa3826*0x64/_0x584fca;_0x2d50f6==0x0&&_0x41e2d1++;}else _0x41e2d1++;_0x37be07['codeCoverage'][_0xa587c4(0x1f7)](new CodeCoverageResult(_0x1b14b5));}),console[_0x120d9d(0x24c)](_0x412d8a);if(_0x412d8a!=0x0){let _0x53e1ab=(_0x412d8a-_0x4b1a51)*0x64/_0x412d8a;this[_0x120d9d(0x1f5)]=Math['round'](_0x53e1ab);}}console['log'](_0x120d9d(0x23a)+0x4),_0x34206c[_0x120d9d(0x20b)][_0x120d9d(0x207)][_0x120d9d(0x242)]!=null&&_0x34206c[_0x120d9d(0x20b)][_0x120d9d(0x207)][_0x120d9d(0x242)]['forEach'](_0x1a000e=>{const _0x20a4d8=_0x120d9d;_0x37be07[_0x20a4d8(0x242)][_0x20a4d8(0x1f7)](new CodeCoverageWarning(_0x1a000e));}),console['log']('Proccess\x20'+0x5),_0x34206c[_0x120d9d(0x20b)][_0x120d9d(0x207)][_0x120d9d(0x1e9)]!=null&&_0x34206c[_0x120d9d(0x20b)][_0x120d9d(0x207)][_0x120d9d(0x1e9)][_0x120d9d(0x24a)](_0x169a70=>{const _0x11f251=_0x120d9d;_0x37be07['flowCoverageWarnings'][_0x11f251(0x1f7)](new FlowCoverageWarning(_0x169a70));}),console[_0x120d9d(0x24c)]('Proccess\x20'+0x6),_0x34206c[_0x120d9d(0x20b)][_0x120d9d(0x207)]['flowCoverage']!=null&&_0x34206c[_0x120d9d(0x20b)][_0x120d9d(0x207)]['flowCoverage'][_0x120d9d(0x24a)](_0x6d0e27=>{const _0x2c7bfa=_0x120d9d;_0x37be07['flowCoverage'][_0x2c7bfa(0x1f7)](new FlowCoverageResult(_0x6d0e27));}),console[_0x120d9d(0x24c)]('Proccess\x20'+0x7),_0x34206c['details'][_0x120d9d(0x207)][_0x120d9d(0x1eb)]!=null&&_0x34206c[_0x120d9d(0x20b)][_0x120d9d(0x207)][_0x120d9d(0x1eb)][_0x120d9d(0x24a)](_0x17b9cb=>{_0x37be07['failures']['push'](new RunTestFailure(_0x17b9cb));}),console['log'](_0x120d9d(0x23a)+0x8),_0x34206c[_0x120d9d(0x20b)][_0x120d9d(0x207)][_0x120d9d(0x223)]!=null&&_0x34206c[_0x120d9d(0x20b)]['runTestResult'][_0x120d9d(0x223)]['forEach'](_0xcf6d81=>{const _0x5f5a77=_0x120d9d;_0x37be07[_0x5f5a77(0x223)][_0x5f5a77(0x1f7)](new RunTestSuccess(_0xcf6d81));}),console[_0x120d9d(0x24c)](_0x120d9d(0x23a)+0x9),this[_0x120d9d(0x217)]=_0x37be07,this[_0x120d9d(0x22a)][_0x120d9d(0x23e)]('Test\x20coverage\x20result\x20was\x20succesfully\x20obtained');}catch(_0x428448){throw new Error(formErrorMessage(_0x428448,_0x120d9d(0x215),this[_0x120d9d(0x22a)]));}}[a2_0x116416(0x1f3)](){const _0x536471=a2_0x116416,_0x334e66=new TestResultWraper();return _0x334e66[_0x536471(0x1db)]=this[_0x536471(0x217)]['success'],_0x334e66[_0x536471(0x20a)]=_0x536471(0x1e7)+this[_0x536471(0x217)][_0x536471(0x20a)],_0x334e66['numFailures']=this[_0x536471(0x217)][_0x536471(0x1de)],_0x334e66['numTestsRun']=this[_0x536471(0x217)][_0x536471(0x23b)],_0x334e66;}[a2_0x116416(0x1fa)](){return new Promise((_0x2c5ca6,_0x9e890)=>{const _0x58a716=a2_0x1984;console[_0x58a716(0x24c)](_0x58a716(0x246)),this[_0x58a716(0x22a)][_0x58a716(0x23e)](_0x58a716(0x20f)),this[_0x58a716(0x24d)][_0x58a716(0x1e4)]=this[_0x58a716(0x1d9)][_0x58a716(0x1e6)],this[_0x58a716(0x24d)][_0x58a716(0x219)]=![],this['logRecord'][_0x58a716(0x222)]=this[_0x58a716(0x1f5)],this[_0x58a716(0x24d)]['Deployment_Name__c']=this[_0x58a716(0x1e8)];const _0x225e0e=addObjectFieldsPrefix(this[_0x58a716(0x24d)],this[_0x58a716(0x1f6)]);console[_0x58a716(0x24c)](_0x58a716(0x1e3),_0x225e0e),this[_0x58a716(0x23d)][_0x58a716(0x1fb)](this[_0x58a716(0x1f6)]+'Test_Log__c')['create'](_0x225e0e)[_0x58a716(0x220)](_0x285e8f=>{const _0x32faa7=_0x58a716;this[_0x32faa7(0x23f)]=_0x285e8f['id'],this[_0x32faa7(0x22a)][_0x32faa7(0x23e)]('Test\x20Log\x20record\x20was\x20created'),console[_0x32faa7(0x24c)](this['logRecordId']),_0x2c5ca6(_0x285e8f['id']);})[_0x58a716(0x24b)](_0x3564dd=>_0x9e890(formErrorMessage(_0x3564dd,_0x58a716(0x1fa),this[_0x58a716(0x22a)])));});}[a2_0x116416(0x202)](){return new Promise((_0x1f9deb,_0x3534b7)=>{const _0x6f75c=a2_0x1984;console[_0x6f75c(0x24c)](_0x6f75c(0x1df)),this[_0x6f75c(0x22a)][_0x6f75c(0x23e)](_0x6f75c(0x244));let _0x2332e8=JSON[_0x6f75c(0x229)](this[_0x6f75c(0x217)]);console[_0x6f75c(0x24c)](_0x6f75c(0x22e)+_0x2332e8[_0x6f75c(0x21d)]+',\x20'+_0x2332e8['length']/0xf4240+'mb');_0x2332e8[_0x6f75c(0x21d)]>=0x23*0xf4240&&(console['log']('testResultString\x20>\x2035mb'),this[_0x6f75c(0x22a)][_0x6f75c(0x23e)]('Test\x20Result\x20Details\x20more\x20than\x2035mb!'),_0x2332e8=JSON[_0x6f75c(0x229)](this[_0x6f75c(0x1f3)]()));const _0x1fda7b=Buffer[_0x6f75c(0x1fc)](_0x2332e8)[_0x6f75c(0x1d8)]('base64'),_0x169f58=new Attachment();_0x169f58[_0x6f75c(0x208)]=_0x1fda7b,_0x169f58[_0x6f75c(0x221)]=_0x6f75c(0x224),console['log'](this[_0x6f75c(0x23f)]),_0x169f58[_0x6f75c(0x241)]=this[_0x6f75c(0x23f)],_0x169f58['ParentId']=this[_0x6f75c(0x23f)],_0x169f58[_0x6f75c(0x23c)]=_0x6f75c(0x247),this[_0x6f75c(0x23d)][_0x6f75c(0x1fb)](_0x6f75c(0x22c))[_0x6f75c(0x1fe)](_0x169f58)[_0x6f75c(0x220)](_0xd0c26a=>{const _0x512c53=_0x6f75c;console[_0x512c53(0x24c)](_0xd0c26a['id']),this[_0x512c53(0x22a)][_0x512c53(0x23e)](_0x512c53(0x234)),_0x1f9deb(_0xd0c26a);})[_0x6f75c(0x24b)](_0x474fb0=>_0x3534b7(formErrorMessage(_0x474fb0,_0x6f75c(0x202),this['logger'])));});}['_updateOrg'](){return new Promise((_0x2904a1,_0x3dc677)=>{const _0x2d8180=a2_0x1984;console[_0x2d8180(0x24c)](_0x2d8180(0x21a)),this[_0x2d8180(0x22a)][_0x2d8180(0x23e)]('Update\x20org'),Promise[_0x2d8180(0x226)]()[_0x2d8180(0x220)](()=>{const _0x54f3dc=_0x2d8180;return this['connectionSource']['sobject'](this['namespacePrefix']+_0x54f3dc(0x237))[_0x54f3dc(0x225)](this[_0x54f3dc(0x24d)]['Org__c']);})[_0x2d8180(0x220)](_0x292296=>{const _0x14249a=_0x2d8180,_0x530dcd=new Organisation__c(_0x292296,this[_0x14249a(0x1f6)]);_0x530dcd[_0x14249a(0x20c)]=this[_0x14249a(0x1f5)],_0x530dcd[_0x14249a(0x204)]=_0x14249a(0x233)+this[_0x14249a(0x1f6)][_0x14249a(0x22f)]()+_0x14249a(0x238)+this[_0x14249a(0x23f)];const {Overall_Code_Coverage__c:_0x1e6c85,Lattest_Test_Execution_Result__c:_0x35936a,Id:_0x496e42}=_0x530dcd,_0x3ef152=addObjectFieldsPrefix({'Overall_Code_Coverage__c':_0x1e6c85,'Lattest_Test_Execution_Result__c':_0x35936a,'Id':_0x496e42},this['namespacePrefix']);return this[_0x14249a(0x23d)]['sobject'](this[_0x14249a(0x1f6)]+_0x14249a(0x237))[_0x14249a(0x1ef)](_0x3ef152);})['then'](_0x1b91c3=>{const _0x35ff4f=_0x2d8180;this[_0x35ff4f(0x22a)][_0x35ff4f(0x23e)](_0x35ff4f(0x1e0)),_0x2904a1(_0x1b91c3);})[_0x2d8180(0x24b)](_0xe92832=>_0x3dc677(formErrorMessage(_0xe92832,_0x2d8180(0x228),this[_0x2d8180(0x22a)])));});}[a2_0x116416(0x1e5)](){return new Promise((_0x47de67,_0x12145e)=>{const _0x22f80f=a2_0x1984;console['log'](_0x22f80f(0x232)),this[_0x22f80f(0x22a)][_0x22f80f(0x23e)]('Finishing\x20of\x20the\x20process'),this[_0x22f80f(0x24d)][_0x22f80f(0x1e4)]=this[_0x22f80f(0x1d9)][_0x22f80f(0x1f8)],this[_0x22f80f(0x24d)][_0x22f80f(0x219)]=!![],this[_0x22f80f(0x24d)]['Id']=this[_0x22f80f(0x23f)];const {Status__c:_0x12c163,Job_Completed__c:_0x3c5af9,Id:_0x7be3e4}=this[_0x22f80f(0x24d)],_0x3d4e4c=addObjectFieldsPrefix({'Status__c':_0x12c163,'Job_Completed__c':_0x3c5af9,'Id':_0x7be3e4},this[_0x22f80f(0x1f6)]);this[_0x22f80f(0x23d)]['sobject'](this[_0x22f80f(0x1f6)]+'Test_Log__c')[_0x22f80f(0x1ef)](_0x3d4e4c)[_0x22f80f(0x220)](_0x5c42cb=>{const _0x12af95=_0x22f80f;this[_0x12af95(0x22a)][_0x12af95(0x23e)]('Process\x20has\x20been\x20finished'),this[_0x12af95(0x22a)]['finish'](this[_0x12af95(0x23f)]),_0x47de67(_0x5c42cb['id']);})[_0x22f80f(0x24b)](_0x160e00=>_0x12145e(formErrorMessage(_0x160e00,_0x22f80f(0x1e5),this[_0x22f80f(0x22a)])));});}}module[a2_0x116416(0x203)]=Process;